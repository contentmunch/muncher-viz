"use strict";(self.webpackChunk_contentmunch_muncher_viz=self.webpackChunk_contentmunch_muncher_viz||[]).push([[816],{"./src/pieChart/PieChart.stories.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:function(){return Default},__namedExportsOrder:function(){return __namedExportsOrder},default:function(){return PieChart_stories}});var objectSpread2=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),arrayLikeToArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js");var unsupportedIterableToArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js");function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return(0,arrayLikeToArray.Z)(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||(0,unsupportedIterableToArray.Z)(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var _Default$parameters,_Default$parameters2,_Default$parameters2$,slicedToArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),react=__webpack_require__("./node_modules/react/index.js"),src=__webpack_require__("./node_modules/d3/src/index.js"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),PieChart_PieChart=function PieChart(_ref){var data=_ref.data,withLegend=_ref.withLegend,legendTitle=_ref.legendTitle,onClick=_ref.onClick,valueFormatter=_ref.valueFormatter,colorRange=_ref.colorRange,chartRef=react.createRef(),legendRef=react.createRef(),clickHandler=(0,react.useCallback)((function(e,d){onClick&&onClick(d.index)}),[onClick]);return(0,react.useEffect)((function(){var pie=src.ve8().padAngle(.005).sort(null).value((function(d){return d.value})),arc=src.Nb1().innerRadius(0).outerRadius(49),pieData=pie(data),legendText=function legendText(data,index){return data.legend?data.legend:data.title+" ("+formatNumber(data.value,index)+")"},formatNumber=function formatNumber(num,index){return valueFormatter?valueFormatter(num,index):num},color=src.PKp().domain(src.Wem(data,(function(d){return d.title}))).range(colorRange||["#4e79a7","#59a14f","#f28e2c","#e15759","#261759","#acd643","#daf2dc"]),chart=src.Ys(chartRef.current).attr("viewBox","-50 -50 100 100");if(chart.selectAll("g").remove(),chart.selectAll("path").remove(),chart.selectAll("path").data(pieData).join("path").on("click",clickHandler).classed("selected",(function(d){return d.data.isSelected})).attr("fill",(function(d){return color(d.data.title)})).attr("fill-opacity",.9).attr("d",arc).append("title").text((function(d){return legendText(d.data,d.index)})),chart.append("g").classed("text",!0).attr("text-anchor","middle").selectAll("text").data(pieData).join("text").attr("transform",(function(d){return"translate(".concat(arc.centroid(d),")")})).call((function(text){return text.filter((function(d){return d.endAngle-d.startAngle>.4})).append("tspan").attr("y","-0.4em").classed("title",!0).text((function(d){return d.data.title}))})).call((function(text){return text.filter((function(d){return d.endAngle-d.startAngle>.4})).append("tspan").attr("x",0).attr("y","0.7em").attr("fill-opacity",.7).classed("value",!0).text((function(d){return"("+formatNumber(d.data.value,d.index)+")"}))})),withLegend){var legend=src.Ys(legendRef.current).attr("viewBox","0 0 70 100");legend.selectAll("g").remove(),legend.selectAll("text").remove(),legend.append("text").text(legendTitle||"Legend").attr("y",10).attr("x",6).classed("legend-title",!0);var legendGraphics=legend.selectAll("g").data(pieData).enter().append("g");legendGraphics.attr("transform",(function(d,i){return"translate(6,".concat(10*i+14,")")})).append("rect").data(pieData).attr("width",6).attr("height",6).on("click",clickHandler).classed("legend-rect",!0).classed("legend-rect--selected",(function(d){return d.data.isSelected})).attr("fill",(function(d){return color(d.data.title)})).attr("fill-opacity",.9),legendGraphics.append("text").data(pieData).text((function(d){return legendText(d.data,d.index)})).on("click",clickHandler).classed("legend-text",!0).classed("legend-text--selected",(function(d){return d.data.isSelected})).attr("y",4).attr("x",8)}}),[chartRef,clickHandler,data,legendRef,legendTitle,valueFormatter,withLegend,colorRange]),(0,jsx_runtime.jsxs)("div",{className:"muncher-pie-chart",children:[(0,jsx_runtime.jsx)("svg",{ref:chartRef,className:"svg-pie-chart"}),withLegend?(0,jsx_runtime.jsx)("svg",{className:"svg-pie-chart-legend",ref:legendRef}):""]})};try{PieChart_PieChart.displayName="PieChart",PieChart_PieChart.__docgenInfo={description:"",displayName:"PieChart",props:{data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"PieChartData[]"}},withLegend:{defaultValue:null,description:"",name:"withLegend",required:!1,type:{name:"boolean"}},legendTitle:{defaultValue:null,description:"",name:"legendTitle",required:!1,type:{name:"string"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!1,type:{name:"((index: number) => void)"}},valueFormatter:{defaultValue:null,description:"",name:"valueFormatter",required:!1,type:{name:"((num: number, index: number) => string)"}},colorRange:{defaultValue:null,description:"",name:"colorRange",required:!1,type:{name:"string[]"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/pieChart/PieChart.tsx#PieChart"]={docgenInfo:PieChart_PieChart.__docgenInfo,name:"PieChart",path:"src/pieChart/PieChart.tsx#PieChart"})}catch(__react_docgen_typescript_loader_error){}var PieChart_stories={title:"Chart/Pie Chart",component:PieChart_PieChart},Default=function Template(args){var _useState=(0,react.useState)(0),_useState2=(0,slicedToArray.Z)(_useState,2),selectedIndex=_useState2[0],setSelectedIndex=_useState2[1],_useState3=(0,react.useState)([{title:"First",value:60,isSelected:!0,legend:"First (23: 60%)"},{title:"Second",value:1,isSelected:!1},{title:"Third",value:5,isSelected:!1}]),_useState4=(0,slicedToArray.Z)(_useState3,2),pieData=_useState4[0],setPieData=_useState4[1];return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(PieChart_PieChart,{data:pieData,onClick:function handleOnClick(index){var currentData=_toConsumableArray(pieData);currentData[index].isSelected?(currentData[index].isSelected=!1,setSelectedIndex(-1)):(currentData.forEach((function(value){value.isSelected=!1})),setSelectedIndex(index),currentData[index].isSelected=!0),setPieData(currentData)},valueFormatter:function valueFormatter(num){return num+"%"},withLegend:!0}),(0,jsx_runtime.jsx)("button",{onClick:function handleButtonClicked(){var currentData=_toConsumableArray(pieData);currentData[1].value=1===currentData[1].value?10:1,setPieData(currentData)},children:"Change Data"}),-1!==selectedIndex?(0,jsx_runtime.jsxs)("p",{children:["Selected: ",pieData[selectedIndex].title]}):""]})}.bind({});Default.parameters=(0,objectSpread2.Z)((0,objectSpread2.Z)({},Default.parameters),{},{docs:(0,objectSpread2.Z)((0,objectSpread2.Z)({},null===(_Default$parameters=Default.parameters)||void 0===_Default$parameters?void 0:_Default$parameters.docs),{},{source:(0,objectSpread2.Z)({originalSource:'args => {\n  const [selectedIndex, setSelectedIndex] = useState(0);\n  const [pieData, setPieData] = useState<PieChartData[]>([{\n    title: "First",\n    value: 60,\n    isSelected: true,\n    legend: "First (23: 60%)"\n  }, {\n    title: "Second",\n    value: 1,\n    isSelected: false\n  }, {\n    title: "Third",\n    value: 5,\n    isSelected: false\n  }]);\n  const handleButtonClicked = () => {\n    const currentData = [...pieData];\n    currentData[1].value = currentData[1].value === 1 ? 10 : 1;\n    setPieData(currentData);\n  };\n  const handleOnClick = (index: number) => {\n    const currentData = [...pieData];\n    if (currentData[index].isSelected) {\n      currentData[index].isSelected = false;\n      setSelectedIndex(-1);\n    } else {\n      currentData.forEach(value => {\n        value.isSelected = false;\n      });\n      setSelectedIndex(index);\n      currentData[index].isSelected = true;\n    }\n    setPieData(currentData);\n  };\n  return <>\n            <PieChart data={pieData} onClick={handleOnClick} valueFormatter={num => {\n      return num + "%";\n    }} withLegend={true} />\n            <button onClick={handleButtonClicked}>Change Data</button>\n            {selectedIndex !== -1 ? <p>Selected: {pieData[selectedIndex].title}</p> : ""}\n        </>;\n}'},null===(_Default$parameters2=Default.parameters)||void 0===_Default$parameters2||null===(_Default$parameters2$=_Default$parameters2.docs)||void 0===_Default$parameters2$?void 0:_Default$parameters2$.source)})});var __namedExportsOrder=["Default"]}}]);